// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id                                 Int                     @id @default(autoincrement())
  name                               String                  @db.VarChar(30)
  email                              String                  @db.VarChar(60) @unique
  password                           String
  telp                               String                  @db.VarChar(20) @unique
  admin_id                           Int                     @unique
  master_id                          Int                     @unique
  jamaah_id                          Int                     @unique
  isVerified                         Boolean                 @default(false)
  isVerifiedByAdmin                  Boolean                 @default(false)
  tokenVerification                  String                  @unique

  admin                              Admins                  @relation(fields: [admin_id], references: [id])
  master                             Masters                 @relation(fields: [master_id], references: [id])
  jamaah                             Jamaahs                 @relation(fields: [jamaah_id], references: [id])
  Loanings                           LoaningBooks[]
} 

model Admins {
  id                                 Int                     @id  @default(autoincrement())
  status                             Boolean                 @default(false)
  role                               AdminRole

  users                              Users[]
}

model Masters {
  id                                 Int                     @id @default(autoincrement())
  status                             Boolean                 @default(false)
    
  users                              Users[]
}

model CriticsAndSuggestion {
  id                                 Int                     @id @default(autoincrement())
  message                            String
}

model Jamaahs {
  id                                 Int                     @id @default(autoincrement())
  masjid_id                          Int

  users                              Users[]
  masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model Masjids {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  location                           String
  subdistrict_id                     Int 
  cityorregency_id                   Int
  province_id                        Int
  ward_id                            Int
  verified                           Boolean                 @default(false)

  jamaah                             Jamaahs[]
  activityinformations               ActivityInformations[]
  incomes                            Incomes[]
  incomes_sources                    IncomeSources[]
  outcomes                           Outcomes[]
  outcomes_reason                    OutcomeReason[]
  assets                             Assets[]
  accountBank                        AccountBank[]      
  purpose                            PurposeAccountBank[]
  mosqueArsips                       MosqueArsips[]
  mosqueLetterTemplate               MosqueLetterTemplate[]
  donation                           Donation[]
  books                              Books[]
  contents                           Contents[]
}

model Incomes {
  id                                 Int                    @id @default(autoincrement())
  amount                             Float                  
  date                               DateTime
  masjid_id                          Int
  source                             String

  masjid                             Masjids                @relation(fields: [masjid_id], references: [id])
}

model IncomeSources {
  id                                 Int                    @id @default(autoincrement())
  masjid_id                          Int                     
  name                               String

  masjid                             Masjids                @relation(fields: [masjid_id], references: [id])
}

model Outcomes {
  id                                 Int                    @id @default(autoincrement())
  amount                             Float             
  date                               DateTime
  reason                             String
  isActivity                         Boolean                @default(false)
  masjid_id                          Int

  masjid                             Masjids                @relation(fields: [masjid_id], references: [id])
  aset                               Assets?
  activity                           ActivityOutcomes?    
}

model OutcomeReason {
  id                                 Int                    @id @default(autoincrement())
  masjid_id                          Int                     
  name                               String

  masjid                             Masjids                @relation(fields: [masjid_id], references: [id])
}

model ActivityInformations {
  id                                 Int                     @id @default(autoincrement())
  date                               DateTime
  address                            String
  image                              String?
  name                               String
  description                        String
  pic                                String
  document                           String?
  masjid_id                          Int
  video_documentation                String?

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
  Pengeluaran                        ActivityOutcomes[] 
}

model ActivityOutcomes {
  id                                 Int                     @id @default(autoincrement())
  activity_id                        Int                    
  outcome_id                         Int                     @unique

  activity                           ActivityInformations    @relation(fields: [activity_id], references: [id])
  outcomes                           Outcomes                @relation(fields: [outcome_id], references: [id])
}

model Assets {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  amount                             Int
  unit                               String
  masjid_id                          Int
  condition                          Condition 
  outcomes_id                        Int                     @unique              

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
  Pengeluaran                        Outcomes                @relation(fields: [outcomes_id], references: [id])
}

model MosqueArsips {
  id                                 Int                     @id @default(autoincrement())
  title                              String                  
  masjid_id                          Int
  document                           String

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model MosqueLetterTemplate {
  id                                 Int                     @id @default(autoincrement())
  masjid_id                          Int
  document                           String
  type                               String

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model Donation {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  masjid_id                          Int
  verified                           Boolean                 @default(false)
  amount                             Int
  image                              String
  type                               String
  incomes_id                         Int?

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}


model AccountBank {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  image                              String?
  bank                               String
  account                            String?
  alias_name                         String
  email                              String
  masjid_id                          Int
  purpose                            String

  masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model PurposeAccountBank {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  masjid_id                          Int

  masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model Books {
  id                                 Int                     @id @default(autoincrement())
  name                               String
  description                        String
  isBorrow                           Boolean                 @default(false)
  masjid_id                          Int

  Masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
  Loaning                            LoaningBooks[]
}

model LoaningBooks {
  id                                 Int                     @id @default(autoincrement())
  users_id                           Int
  books_id                           Int

  User                               Users                   @relation(fields: [users_id], references: [id])
  Book                               Books                   @relation(fields: [books_id], references: [id])
}

model Contents {
  id                                 Int                     @id @default(autoincrement())
  masjid_id                          Int
  title                              String
  post_date                          DateTime
  contents                           String
  visual_content                     String?

  masjid                             Masjids                 @relation(fields: [masjid_id], references: [id])
}

model Configuration {
  id                                 Int                      @id @default(autoincrement())
  masjid_id                          Int                      @unique
  is_article_used                    Boolean
  is_donation_used                   Boolean
  is_activity_outcomes_connected     Boolean
  is_asset_outcomes_connected        Boolean
  is_template_documents_used         Boolean
}

enum AdminRole {
  Ketua
  Bendahara
  Sekretaris
  Pengurus
  Ustad
  Donatur
}

enum Condition {
  Baik
  Sedang_diperbaiki
  Rusak
}

enum PaymentStatus {
  PAID
  PENDING
}
